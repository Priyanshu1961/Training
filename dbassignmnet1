               <!-- Create Table AccidentsData-->

CREATE TABLE AccidentsData(
   serial_id serial PRIMARY KEY     NOT NULL,
   statename  TEXT    NOT NULL,
   year_2006   numeric(10,0),
   year_2007   numeric(10,0),
   year_2008   numeric(10,0),
   year_2009   numeric(10,0),
   year_2010   numeric(10,0),
   year_2011   numeric(10,0),
   year_2012   numeric(10,0)

);

              <!-- Import data From CSV file into postgres table -->

COPY AccidentsData(statename,year_2006,year_2007,year_2008,year_2009,year_2010,year_2011,year_2012)
FROM '/home/user/Downloads/accdata.csv' DELIMITER ',' CSV HEADER;

               <!-- Create Views-->


CREATE VIEW view_year2006 AS SELECT statename FROM AccidentsData  ORDER BY year_2006 DESC LIMIT 3 ;

CREATE VIEW view_year2007 AS SELECT statename FROM AccidentsData  ORDER BY year_2007 DESC LIMIT 3 ;

CREATE VIEW view_year2008 AS SELECT statename FROM AccidentsData  ORDER BY year_2008 DESC LIMIT 3 ;

CREATE VIEW view_year2009 AS SELECT statename FROM AccidentsData  ORDER BY year_2009 DESC LIMIT 3 ;

CREATE VIEW view_year2010 AS SELECT statename FROM AccidentsData  ORDER BY year_2010 DESC LIMIT 3 ;

CREATE VIEW view_year2011 AS SELECT statename FROM AccidentsData  ORDER BY year_2011 DESC LIMIT 3 ;

CREATE VIEW view_year2012 AS SELECT statename FROM AccidentsData  ORDER BY year_2012 DESC LIMIT 3 ;

                               <!--Display the output using join query-->

\set val 5


Select Val1,Val2,val3,val4,val5,val6,val7 from (select statename as Val1, ROW_NUMBER() over (order by :val) r from view_year2006) a
join (select statename as Val2, ROW_NUMBER() over (order by :val) r from view_year2007) b on a.r=b.r
join (select statename as Val3, ROW_NUMBER() over (order by :val) r from view_year2008) c on b.r=c.r
join (select statename as Val4, ROW_NUMBER() over (order by :val) r from view_year2009) d on c.r=d.r
join (select statename as Val5, ROW_NUMBER() over (order by :val) r from view_year2010) e on d.r=e.r
join (select statename as Val6, ROW_NUMBER() over (order by :val) r from view_year2011) f on e.r=f.r
join (select statename as Val7, ROW_NUMBER() over (order by :val) r from view_year2012) g on f.r=g.r;
